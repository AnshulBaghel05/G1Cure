import{r as e,j as s,c as t,d as a,P as i,b as n,u as l,e as r,m as c,n as o}from"./ui-77ih3y5-.js";import{u as d}from"./useQuery-Dlp3A4Ud.js";import{c as m,K as x,x as p,y as h,j as u,k as j,l as g,z as v,X as y,m as f,I as b,M as N,q as w,a as k,n as C,D as S,g as D,E as A,f as I,d as T,P as F,G as E,J as R}from"./index-Dujr78kO.js";import{u as _}from"./useMutation-DHGRmv7m.js";import{L as q}from"./label-l12jvvxt.js";import{T as z}from"./textarea-DP8UPA2I.js";import{S as M,a as P,b as L,c as O,d as $}from"./select-DGXQeRqO.js";import{b as W}from"./client-B8Nu1JAV.js";import{C as K}from"./check-QCXJeeDZ.js";import{S as H}from"./StandardModal-Bu4nfB9c.js";import{m as V,A as B}from"./animations-B6zYn4RS.js";import{S as Q}from"./star-B3qPTRTo.js";import{C as J}from"./clock-BSH9Dcvi.js";import{S as U}from"./sparkles-CqxsogJG.js";import{B as G}from"./brain-DV2drEwe.js";import{M as X}from"./map-pin-Duk6Xe_d.js";import{Z as Y}from"./zap-By7jCCCX.js";import{T as Z}from"./trending-up-B_ehj4Dk.js";import{S as ee}from"./square-pen-DnvHHSTd.js";import{T as se}from"./trash-2-CfuxWZSG.js";import{A as te}from"./activity-7thVPbvO.js";import"./vendor-DZByZrCh.js";import"./charts-BdQpHC93.js";import"./chevron-down-CaI_Em0f.js";
/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=m("thumbs-up",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);var ie="Checkbox",[ne,le]=t(ie),[re,ce]=ne(ie);function oe(t){const{__scopeCheckbox:a,checked:i,children:l,defaultChecked:r,disabled:c,form:o,name:d,onCheckedChange:m,required:x,value:p="on",internal_do_not_use_render:h}=t,[u,j]=n({prop:i,defaultProp:r??!1,onChange:m,caller:ie}),[g,v]=e.useState(null),[y,f]=e.useState(null),b=e.useRef(!1),N=!g||(!!o||!!g.closest("form")),w={checked:u,disabled:c,setChecked:j,control:g,setControl:v,name:d,form:o,value:p,hasConsumerStoppedPropagationRef:b,required:x,defaultChecked:!ve(r)&&r,isFormControl:N,bubbleInput:y,setBubbleInput:f};return s.jsx(re,{scope:a,...w,children:ge(h)?h(w):l})}var de="CheckboxTrigger",me=e.forwardRef(({__scopeCheckbox:t,onKeyDown:a,onClick:n,...c},o)=>{const{control:d,value:m,disabled:x,checked:p,required:h,setControl:u,setChecked:j,hasConsumerStoppedPropagationRef:g,isFormControl:v,bubbleInput:y}=ce(de,t),f=l(o,u),b=e.useRef(p);return e.useEffect(()=>{const e=null==d?void 0:d.form;if(e){const s=()=>j(b.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[d,j]),s.jsx(i.button,{type:"button",role:"checkbox","aria-checked":ve(p)?"mixed":p,"aria-required":h,"data-state":ye(p),"data-disabled":x?"":void 0,disabled:x,value:m,...c,ref:f,onKeyDown:r(a,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:r(n,e=>{j(e=>!!ve(e)||!e),y&&v&&(g.current=e.isPropagationStopped(),g.current||e.stopPropagation())})})});me.displayName=de;var xe=e.forwardRef((e,t)=>{const{__scopeCheckbox:a,name:i,checked:n,defaultChecked:l,required:r,disabled:c,value:o,onCheckedChange:d,form:m,...x}=e;return s.jsx(oe,{__scopeCheckbox:a,checked:n,defaultChecked:l,disabled:c,required:r,onCheckedChange:d,name:i,form:m,value:o,internal_do_not_use_render:({isFormControl:e})=>s.jsxs(s.Fragment,{children:[s.jsx(me,{...x,ref:t,__scopeCheckbox:a}),e&&s.jsx(je,{__scopeCheckbox:a})]})})});xe.displayName=ie;var pe="CheckboxIndicator",he=e.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:l,...r}=e,c=ce(pe,n);return s.jsx(a,{present:l||ve(c.checked)||!0===c.checked,children:s.jsx(i.span,{"data-state":ye(c.checked),"data-disabled":c.disabled?"":void 0,...r,ref:t,style:{pointerEvents:"none",...e.style}})})});he.displayName=pe;var ue="CheckboxBubbleInput",je=e.forwardRef(({__scopeCheckbox:t,...a},n)=>{const{control:r,hasConsumerStoppedPropagationRef:d,checked:m,defaultChecked:x,required:p,disabled:h,name:u,value:j,form:g,bubbleInput:v,setBubbleInput:y}=ce(ue,t),f=l(n,y),b=c(m),N=o(r);e.useEffect(()=>{const e=v;if(!e)return;const s=window.HTMLInputElement.prototype,t=Object.getOwnPropertyDescriptor(s,"checked").set,a=!d.current;if(b!==m&&t){const s=new Event("click",{bubbles:a});e.indeterminate=ve(m),t.call(e,!ve(m)&&m),e.dispatchEvent(s)}},[v,b,m,d]);const w=e.useRef(!ve(m)&&m);return s.jsx(i.input,{type:"checkbox","aria-hidden":!0,defaultChecked:x??w.current,required:p,disabled:h,name:u,value:j,form:g,...a,tabIndex:-1,ref:f,style:{...a.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function ge(e){return"function"==typeof e}function ve(e){return"indeterminate"===e}function ye(e){return ve(e)?"indeterminate":e?"checked":"unchecked"}function fe({className:e,...t}){return s.jsx(xe,{"data-slot":"checkbox",className:x("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:s.jsx(he,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:s.jsx(K,{className:"size-3.5"})})})}function be({appointment:t,patients:a,doctors:i,onClose:n,onSuccess:l}){var r;const{t:c}=p(),{toast:o}=h(),d=!!t,[m,x]=e.useState({patientId:(null==t?void 0:t.patientId)||"",doctorId:(null==t?void 0:t.doctorId)||"",appointmentDate:(null==t?void 0:t.appointmentDate)?new Date(t.appointmentDate).toISOString().slice(0,16):"",duration:(null==(r=null==t?void 0:t.duration)?void 0:r.toString())||"30",type:(null==t?void 0:t.type)||"consultation",status:(null==t?void 0:t.status)||"scheduled",notes:(null==t?void 0:t.notes)||"",symptoms:(null==t?void 0:t.symptoms)||"",diagnosis:(null==t?void 0:t.diagnosis)||"",prescription:(null==t?void 0:t.prescription)||""}),N=_({mutationFn:async e=>await W.clinic.createAppointment(e),onSuccess:()=>{l()},onError:e=>{o({title:c("common.error"),description:"Failed to create appointment",variant:"destructive"})}}),w=_({mutationFn:async e=>await W.clinic.updateAppointment(e),onSuccess:()=>{l()},onError:e=>{o({title:c("common.error"),description:"Failed to update appointment",variant:"destructive"})}}),k=(e,s)=>{x(t=>({...t,[e]:s}))},C=N.isPending||w.isPending;return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:e=>e.target===e.currentTarget&&n(),children:s.jsx("div",{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:s.jsxs(u,{children:[s.jsxs(j,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[s.jsx(g,{className:"text-xl",children:d?"Edit Appointment":c("appointments.add")}),s.jsx(v,{variant:"ghost",size:"sm",onClick:n,children:s.jsx(y,{className:"w-4 h-4"})})]}),s.jsx(f,{children:s.jsxs("form",{onSubmit:async e=>{e.preventDefault();const s={...m,appointmentDate:new Date(m.appointmentDate),duration:parseInt(m.duration)};d&&t?w.mutate({id:t.id,...s}):N.mutate(s)},className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"patientId",children:c("appointments.patient")}),s.jsxs(M,{value:m.patientId,onValueChange:e=>k("patientId",e),children:[s.jsx(P,{children:s.jsx(L,{placeholder:"Select patient"})}),s.jsx(O,{children:a.map(e=>s.jsxs($,{value:e.id,children:[e.firstName," ",e.lastName]},e.id))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"doctorId",children:c("appointments.doctor")}),s.jsxs(M,{value:m.doctorId,onValueChange:e=>k("doctorId",e),children:[s.jsx(P,{children:s.jsx(L,{placeholder:"Select doctor"})}),s.jsx(O,{children:i.map(e=>s.jsxs($,{value:e.id,children:["Dr. ",e.firstName," ",e.lastName," - ",e.specialization]},e.id))})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"appointmentDate",children:c("appointments.appointmentDate")}),s.jsx(b,{id:"appointmentDate",type:"datetime-local",value:m.appointmentDate,onChange:e=>k("appointmentDate",e.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"duration",children:c("appointments.duration")}),s.jsx(b,{id:"duration",type:"number",min:"15",step:"15",value:m.duration,onChange:e=>k("duration",e.target.value),required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"type",children:c("appointments.type")}),s.jsxs(M,{value:m.type,onValueChange:e=>k("type",e),children:[s.jsx(P,{children:s.jsx(L,{})}),s.jsxs(O,{children:[s.jsx($,{value:"consultation",children:"Consultation"}),s.jsx($,{value:"follow-up",children:"Follow-up"}),s.jsx($,{value:"emergency",children:"Emergency"}),s.jsx($,{value:"telemedicine",children:"Telemedicine"})]})]})]}),d&&s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"status",children:c("common.status")}),s.jsxs(M,{value:m.status,onValueChange:e=>k("status",e),children:[s.jsx(P,{children:s.jsx(L,{})}),s.jsxs(O,{children:[s.jsx($,{value:"scheduled",children:"Scheduled"}),s.jsx($,{value:"confirmed",children:"Confirmed"}),s.jsx($,{value:"in-progress",children:"In Progress"}),s.jsx($,{value:"completed",children:"Completed"}),s.jsx($,{value:"cancelled",children:"Cancelled"}),s.jsx($,{value:"no-show",children:"No Show"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"symptoms",children:c("appointments.symptoms")}),s.jsx(z,{id:"symptoms",value:m.symptoms,onChange:e=>k("symptoms",e.target.value),placeholder:"Enter patient symptoms..."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"notes",children:c("appointments.notes")}),s.jsx(z,{id:"notes",value:m.notes,onChange:e=>k("notes",e.target.value),placeholder:"Enter appointment notes..."})]}),d&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"diagnosis",children:c("appointments.diagnosis")}),s.jsx(z,{id:"diagnosis",value:m.diagnosis,onChange:e=>k("diagnosis",e.target.value),placeholder:"Enter diagnosis..."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"prescription",children:c("appointments.prescription")}),s.jsx(z,{id:"prescription",value:m.prescription,onChange:e=>k("prescription",e.target.value),placeholder:"Enter prescription..."})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(v,{type:"submit",disabled:C,className:"flex-1",children:c(C?"common.loading":"common.save")}),s.jsx(v,{type:"button",variant:"outline",onClick:n,disabled:C,children:c("common.cancel")})]})]})})]})})})}function Ne({appointmentId:t,doctorName:a,appointmentDate:i,onClose:n,onSuccess:l}){const{toast:r}=h(),[c,o]=e.useState({appointmentId:t,rating:0,comment:"",serviceQuality:0,communication:0,waitTime:0,cleanliness:0,wouldRecommend:!0,isAnonymous:!1}),d=_({mutationFn:async e=>await W.reviews.createReview(e),onSuccess:()=>{r({title:"Review Submitted",description:"Thank you for your feedback! Your review has been submitted successfully."}),l()},onError:e=>{r({title:"Error",description:e.message||"Failed to submit review.",variant:"destructive"})}}),m=(e,s)=>{o(t=>({...t,[e]:s}))},x=(e,s)=>{o(t=>({...t,[e]:s}))},p=({value:e,onChange:t,label:a,icon:i=Q})=>s.jsxs("div",{className:"space-y-2",children:[s.jsxs(q,{className:"flex items-center gap-2",children:[s.jsx(i,{className:"w-4 h-4"}),a]}),s.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(a=>s.jsx(V.button,{type:"button",onClick:()=>t(a),className:"p-1 rounded transition-colors "+(a<=e?"text-yellow-400":"text-gray-300 hover:text-yellow-200"),whileHover:{scale:1.1},whileTap:{scale:.95},children:s.jsx(Q,{className:"w-6 h-6 "+(a<=e?"fill-current":"")})},a))})]});return s.jsx(H,{isOpen:!0,onClose:n,title:"Rate Your Experience",maxWidth:"max-w-2xl",children:s.jsxs("form",{onSubmit:e=>{e.preventDefault(),0!==c.rating?d.mutate(c):r({title:"Rating Required",description:"Please provide an overall rating.",variant:"destructive"})},className:"space-y-6",children:[s.jsxs("div",{className:"text-center space-y-2 pb-4 border-b",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["How was your appointment with ",a,"?"]}),s.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[i.toLocaleDateString()," at ",i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),s.jsx(u,{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 border-blue-200 dark:border-blue-800",children:s.jsx(f,{className:"p-6",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(q,{className:"text-lg font-semibold",children:"Overall Experience"}),s.jsx("div",{className:"flex justify-center gap-2",children:[1,2,3,4,5].map(e=>s.jsx(V.button,{type:"button",onClick:()=>m("rating",e),className:"p-2 rounded-full transition-colors "+(e<=c.rating?"text-yellow-400":"text-gray-300 hover:text-yellow-200"),whileHover:{scale:1.2},whileTap:{scale:.9},children:s.jsx(Q,{className:"w-8 h-8 "+(e<=c.rating?"fill-current":"")})},e))}),c.rating>0&&s.jsxs(V.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-sm text-gray-600 dark:text-gray-400",children:[1===c.rating&&"We're sorry to hear that. We'll work to improve.",2===c.rating&&"Thank you for the feedback. We'll do better.",3===c.rating&&"Thanks for the feedback. We appreciate it.",4===c.rating&&"Great! We're glad you had a good experience.",5===c.rating&&"Excellent! Thank you for the wonderful feedback."]})]})})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsx(p,{value:c.serviceQuality||0,onChange:e=>m("serviceQuality",e),label:"Service Quality",icon:ae}),s.jsx(p,{value:c.communication||0,onChange:e=>m("communication",e),label:"Communication",icon:N}),s.jsx(p,{value:c.waitTime||0,onChange:e=>m("waitTime",e),label:"Wait Time",icon:J}),s.jsx(p,{value:c.cleanliness||0,onChange:e=>m("cleanliness",e),label:"Cleanliness",icon:U})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(q,{htmlFor:"comment",children:"Share your experience (optional)"}),s.jsx(z,{id:"comment",value:c.comment,onChange:e=>x("comment",e.target.value),placeholder:"Tell us about your experience...",rows:4,className:"resize-none"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(fe,{id:"wouldRecommend",checked:c.wouldRecommend,onCheckedChange:e=>x("wouldRecommend",e)}),s.jsx(q,{htmlFor:"wouldRecommend",className:"text-sm",children:"I would recommend this doctor to others"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(fe,{id:"isAnonymous",checked:c.isAnonymous,onCheckedChange:e=>x("isAnonymous",e)}),s.jsx(q,{htmlFor:"isAnonymous",className:"text-sm",children:"Submit this review anonymously"})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(v,{type:"submit",disabled:d.isPending,className:"flex-1",children:d.isPending?"Submitting...":"Submit Review"}),s.jsx(v,{type:"button",variant:"outline",onClick:n,disabled:d.isPending,children:"Cancel"})]})]})})}function we({onSlotSelect:t,onWaitlistJoin:a,currentRequest:i}){var n,l;const{toast:r}=h(),[c,o]=e.useState(new Date),[d,m]=e.useState("all"),[x,p]=e.useState("all"),[y,b]=e.useState("calendar"),[N,A]=e.useState(!1),I=e.useMemo(()=>{const e=[],s=[{id:"1",name:"Dr. Sarah Johnson",specialization:"Cardiology",rating:4.8,fee:150,location:"Main Clinic"},{id:"2",name:"Dr. Michael Chen",specialization:"Neurology",rating:4.9,fee:180,location:"Main Clinic"},{id:"3",name:"Dr. Emily Rodriguez",specialization:"Pediatrics",rating:4.7,fee:120,location:"Branch Office"},{id:"4",name:"Dr. David Kim",specialization:"Orthopedics",rating:4.6,fee:160,location:"Main Clinic"}];for(let t=0;t<7;t++){const a=new Date(c);a.setDate(a.getDate()+t);for(let i=9;i<17;i++)for(let n=0;n<60;n+=30){const l=new Date(a);l.setHours(i,n,0,0);const r=new Date(l);r.setMinutes(r.getMinutes()+30),s.forEach((s,a)=>{const c=Math.random()>.3,o=c?[]:["Previous appointment","Emergency case"],d=c?0:Math.floor(5*Math.random()),m=100*Math.random();e.push({id:`${t}-${i}-${n}-${s.id}`,startTime:l,endTime:r,isAvailable:c,doctorId:s.id,doctorName:s.name,specialization:s.specialization,rating:s.rating,consultationFee:s.fee,location:s.location,conflicts:o,waitlistCount:d,aiScore:m})})}}return e},[c]),T=e.useMemo(()=>{let e=I;return"all"!==d&&(e=e.filter(e=>e.specialization===d)),"all"!==x&&(e=e.sort((e,s)=>"emergency"===x?s.aiScore-e.aiScore:e.aiScore-s.aiScore)),e},[I,d,x]),F=e.useMemo(()=>T.filter(e=>e.isAvailable).sort((e,s)=>s.aiScore-e.aiScore).slice(0,5),[T]),E=e.useMemo(()=>{const e=T.filter(e=>!e.isAvailable),s=e.reduce((e,s)=>{var t;return null==(t=s.conflicts)||t.forEach(s=>{e[s]=(e[s]||0)+1}),e},{});return{totalConflicts:e.length,conflictTypes:s,mostCommonConflict:Object.entries(s).sort(([,e],[,s])=>s-e)[0]}},[T]);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[s.jsx(G,{className:"w-6 h-6 text-blue-600"}),"Smart Scheduler"]}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"AI-powered appointment scheduling with conflict detection"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(M,{value:y,onValueChange:e=>b(e),children:[s.jsx(P,{className:"w-40",children:s.jsx(L,{})}),s.jsxs(O,{children:[s.jsx($,{value:"calendar",children:"Calendar View"}),s.jsx($,{value:"list",children:"List View"}),s.jsx($,{value:"ai-suggestions",children:"AI Suggestions"})]})]}),s.jsxs(M,{value:d,onValueChange:m,children:[s.jsx(P,{className:"w-40",children:s.jsx(L,{placeholder:"Specialization"})}),s.jsxs(O,{children:[s.jsx($,{value:"all",children:"All Specializations"}),s.jsx($,{value:"Cardiology",children:"Cardiology"}),s.jsx($,{value:"Neurology",children:"Neurology"}),s.jsx($,{value:"Pediatrics",children:"Pediatrics"}),s.jsx($,{value:"Orthopedics",children:"Orthopedics"})]})]}),s.jsxs(M,{value:x,onValueChange:p,children:[s.jsx(P,{className:"w-32",children:s.jsx(L,{placeholder:"Urgency"})}),s.jsxs(O,{children:[s.jsx($,{value:"all",children:"All"}),s.jsx($,{value:"low",children:"Low"}),s.jsx($,{value:"medium",children:"Medium"}),s.jsx($,{value:"high",children:"High"}),s.jsx($,{value:"emergency",children:"Emergency"})]})]})]})]}),N&&E.totalConflicts>0&&s.jsxs(u,{className:"border-orange-200 bg-orange-50",children:[s.jsx(j,{children:s.jsxs(g,{className:"flex items-center gap-2 text-orange-800",children:[s.jsx(w,{className:"w-5 h-5"}),"Conflict Analysis"]})}),s.jsx(f,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:E.totalConflicts}),s.jsx("div",{className:"text-sm text-orange-700",children:"Total Conflicts"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-orange-600",children:null==(n=E.mostCommonConflict)?void 0:n[0]}),s.jsx("div",{className:"text-sm text-orange-700",children:"Most Common Issue"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-lg font-semibold text-orange-600",children:null==(l=E.mostCommonConflict)?void 0:l[1]}),s.jsx("div",{className:"text-sm text-orange-700",children:"Occurrences"})]})]})})]}),s.jsxs(B,{mode:"wait",children:["calendar"===y&&s.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:s.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>s.jsx("div",{className:"text-center font-medium text-gray-600 p-2",children:e},e)),Array.from({length:35},(e,t)=>{const a=new Date(c);a.setDate(a.getDate()-a.getDay()+t);const i=T.filter(e=>e.startTime.toDateString()===a.toDateString()),n=i.filter(e=>e.isAvailable).length,l=i.length;return s.jsxs(V.div,{className:"p-2 border rounded-lg cursor-pointer transition-all duration-200 hover:shadow-md "+(a.toDateString()===c.toDateString()?"bg-blue-100 border-blue-300":"bg-white border-gray-200"),onClick:()=>o(a),whileHover:{scale:1.05},children:[s.jsx("div",{className:"text-sm font-medium",children:a.getDate()}),s.jsxs("div",{className:"text-xs text-gray-500",children:[n,"/",l," slots"]}),n>0&&s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mx-auto mt-1"})]},t)})]})},"calendar"),"list"===y&&s.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:s.jsx("div",{className:"space-y-4",children:T.filter(e=>e.startTime.toDateString()===c.toDateString()).map((e,i)=>{var n;return s.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*i},children:s.jsx(u,{className:"transition-all duration-200 hover:shadow-lg "+(e.isAvailable?"border-green-200":"border-red-200"),children:s.jsxs(f,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center "+(e.isAvailable?"bg-green-100":"bg-red-100"),children:e.isAvailable?s.jsx(k,{className:"w-6 h-6 text-green-600"}):s.jsx(C,{className:"w-6 h-6 text-red-600"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-semibold",children:e.doctorName}),s.jsx(S,{variant:"outline",children:e.specialization}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Q,{className:"w-4 h-4 text-yellow-500 fill-current"}),s.jsx("span",{className:"text-sm",children:e.rating})]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mt-1",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(J,{className:"w-4 h-4"}),s.jsxs("span",{children:[e.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",e.endTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(X,{className:"w-4 h-4"}),s.jsx("span",{children:e.location})]}),s.jsx("div",{className:"flex items-center gap-1",children:s.jsxs("span",{children:["â‚¹",e.consultationFee]})})]})]})]}),s.jsx("div",{className:"flex items-center gap-2",children:e.isAvailable?s.jsx(v,{onClick:()=>t(e),className:"bg-green-600 hover:bg-green-700",children:"Book Now"}):s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm text-red-600 mb-1",children:null==(n=e.conflicts)?void 0:n.join(", ")}),e.waitlistCount&&e.waitlistCount>0&&s.jsxs(v,{variant:"outline",size:"sm",onClick:()=>a(e),children:["Join Waitlist (",e.waitlistCount,")"]})]})})]}),e.aiScore&&s.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-gray-500",children:[s.jsx(G,{className:"w-3 h-3"}),s.jsxs("span",{children:["AI Score: ",e.aiScore.toFixed(1)]})]})]})})},e.id)})})},"list"),"ai-suggestions"===y&&s.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:s.jsx("div",{className:"space-y-6",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:F.map((e,a)=>s.jsx(V.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.1*a},children:s.jsxs(u,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-indigo-50",children:[s.jsx(j,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Y,{className:"w-5 h-5 text-blue-600"}),s.jsx(S,{className:"bg-blue-600",children:"AI Recommended"})]}),s.jsxs("div",{className:"text-sm font-medium text-blue-600",children:["Score: ",e.aiScore.toFixed(1)]})]})}),s.jsxs(f,{children:[s.jsx("h3",{className:"font-semibold mb-2",children:e.doctorName}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(J,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{children:e.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(D,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{children:e.specialization})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Q,{className:"w-4 h-4 text-yellow-500 fill-current"}),s.jsxs("span",{children:[e.rating," rating"]})]})]}),s.jsx(v,{onClick:()=>t(e),className:"w-full mt-3 bg-blue-600 hover:bg-blue-700",children:"Book AI Recommendation"})]})]})},e.id))})})},"ai-suggestions")]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(v,{variant:"outline",onClick:()=>A(!N),className:"flex items-center gap-2",children:[s.jsx(w,{className:"w-4 h-4"}),N?"Hide":"Show"," Conflicts"]}),s.jsxs(v,{variant:"outline",onClick:()=>r({title:"AI Optimization",description:"AI is analyzing your schedule for optimal slot recommendations..."}),className:"flex items-center gap-2",children:[s.jsx(G,{className:"w-4 h-4"}),"Optimize Schedule"]})]})]})}function ke(){const{t:t}=p(),{toast:a}=h(),i=A(),{user:n}=I(),[l,r]=e.useState(""),[c,o]=e.useState(!1),[m,x]=e.useState(null),[y,N]=e.useState(null),[w,k]=e.useState("list"),C="patient"===(null==n?void 0:n.role),{data:q,isLoading:z,error:M}=d({queryKey:["appointments",l,null==n?void 0:n.id],queryFn:async()=>{const e={limit:100};return C&&(e.patientId=n.profile_id),await W.clinic.listAppointments(e)},enabled:!!n}),{data:P}=d({queryKey:["patients"],queryFn:async()=>await W.clinic.listPatients({limit:1e3}),enabled:c&&!C}),{data:L}=d({queryKey:["doctors"],queryFn:async()=>await W.clinic.listDoctors({limit:1e3}),enabled:c}),O=_({mutationFn:async e=>{await W.clinic.deleteAppointment({id:e})},onSuccess:()=>{i.invalidateQueries({queryKey:["appointments"]}),a({title:t("common.success"),description:"Appointment deleted successfully"})},onError:e=>{a({title:t("common.error"),description:"Failed to delete appointment",variant:"destructive"})}}),{data:$}=d({queryKey:["can-review",null==y?void 0:y.id],queryFn:async()=>y?await W.reviews.canReviewAppointment({appointmentId:y.id}):null,enabled:!!y&&C}),K=()=>{o(!1),x(null)},H=()=>{N(null)},B=e=>C?`${null==n?void 0:n.first_name} ${null==n?void 0:n.last_name}`:e.patient?`${e.patient.firstName} ${e.patient.lastName}`:"Unknown Patient",U=e=>e.doctor?`Dr. ${e.doctor.firstName} ${e.doctor.lastName}`:"Unknown Doctor",X=e=>{switch(e){case"scheduled":return"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300";case"confirmed":return"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300";case"in-progress":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300";case"completed":default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300";case"no-show":return"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300"}},Y=e=>{switch(e){case"consultation":return"border-blue-300 text-blue-800 dark:border-blue-700 dark:text-blue-300";case"follow-up":return"border-green-300 text-green-800 dark:border-green-700 dark:text-green-300";case"emergency":return"border-red-300 text-red-800 dark:border-red-700 dark:text-red-300";case"telemedicine":return"border-purple-300 text-purple-800 dark:border-purple-700 dark:text-purple-300";default:return"border-gray-300 text-gray-800 dark:border-gray-600 dark:text-gray-300"}};return M?s.jsx("div",{className:"text-center py-12",children:s.jsxs("p",{className:"text-red-600",children:[t("common.error"),": ",M.message]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("appointments.title")}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Advanced appointment management with AI-powered scheduling"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(v,{variant:"outline",onClick:()=>k("list"),className:"flex items-center gap-2",children:[s.jsx(T,{className:"w-4 h-4"}),"Appointments"]}),s.jsxs(v,{variant:"outline",onClick:()=>k("scheduler"),className:"flex items-center gap-2",children:[s.jsx(G,{className:"w-4 h-4"}),"Smart Scheduler"]}),s.jsxs(v,{variant:"outline",onClick:()=>k("analytics"),className:"flex items-center gap-2",children:[s.jsx(Z,{className:"w-4 h-4"}),"Analytics"]}),s.jsxs(v,{onClick:()=>o(!0),className:"flex items-center gap-2",children:[s.jsx(F,{className:"w-4 h-4"}),C?"Book New Appointment":t("appointments.add")]})]})]}),"list"===w&&s.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"flex items-center gap-4",children:s.jsxs("div",{className:"relative flex-1 max-w-md",children:[s.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),s.jsx(b,{placeholder:C?"Search by doctor or date...":t("common.search"),value:l,onChange:e=>r(e.target.value),className:"pl-10"})]})}),"list"===w&&s.jsxs(s.Fragment,{children:[z?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,t)=>s.jsxs(u,{className:"animate-pulse bg-white dark:bg-gray-800",children:[s.jsxs(j,{children:[s.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),s.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]}),s.jsx(f,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded"}),s.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-2/3"})]})})]},t))}):s.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:null==q?void 0:q.appointments.map((e,a)=>s.jsx(V.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*a},whileHover:{y:-2},children:s.jsxs(u,{className:"h-full transition-all duration-200 hover:shadow-lg dark:bg-gray-800",children:[s.jsx(j,{className:"pb-3",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-purple-100 dark:bg-purple-900/50 rounded-full flex items-center justify-center",children:s.jsx(T,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),s.jsxs("div",{children:[s.jsx(g,{className:"text-lg dark:text-white",children:new Date(e.appointmentDate).toLocaleDateString()}),s.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:new Date(e.appointmentDate).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),s.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[s.jsx(S,{className:X(e.status),children:e.status}),s.jsx(S,{variant:"outline",className:Y(e.type),children:e.type})]})]})}),s.jsxs(f,{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2 text-sm",children:[!C&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(D,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Patient:"}),s.jsx("span",{className:"font-medium dark:text-white",children:B(e)})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(R,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Doctor:"}),s.jsx("span",{className:"font-medium dark:text-white",children:U(e)})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(J,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Duration:"}),s.jsxs("span",{className:"dark:text-white",children:[e.duration," minutes"]})]})]}),e.symptoms&&s.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[s.jsx("span",{className:"font-medium",children:"Symptoms:"})," ",e.symptoms]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(v,{variant:"outline",size:"sm",onClick:()=>(e=>{x(e),o(!0)})(e),className:"flex-1",children:[s.jsx(ee,{className:"w-3 h-3 mr-1"}),t("common.edit")]}),C&&"completed"===e.status&&s.jsxs(v,{variant:"outline",size:"sm",onClick:()=>(e=>{N(e)})(e),className:"flex-1 text-yellow-600 hover:text-yellow-700 hover:bg-yellow-50 dark:text-yellow-400 dark:hover:bg-yellow-900/50",children:[s.jsx(Q,{className:"w-3 h-3 mr-1"}),"Review"]}),!C&&s.jsx(v,{variant:"outline",size:"sm",onClick:()=>(async e=>{window.confirm("Are you sure you want to delete this appointment?")&&O.mutate(e)})(e.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:bg-red-900/50 dark:hover:text-red-300",children:s.jsx(se,{className:"w-3 h-3"})})]})]})]})},e.id))}),0===(null==q?void 0:q.appointments.length)&&!z&&s.jsxs(V.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[s.jsx(T,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No appointments found"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:l?"Try adjusting your search terms":"Get started by scheduling your first appointment"}),s.jsxs(v,{onClick:()=>o(!0),children:[s.jsx(F,{className:"w-4 h-4 mr-2"}),C?"Book New Appointment":t("appointments.add")]})]})]}),"scheduler"===w&&s.jsx(V.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:s.jsx(we,{onSlotSelect:e=>{a({title:"Slot Selected",description:`Selected ${e.doctorName} at ${e.startTime.toLocaleTimeString()}`}),o(!0)},onWaitlistJoin:e=>{a({title:"Waitlist Joined",description:`Added to waitlist for ${e.doctorName}`})},currentRequest:{patientId:(null==n?void 0:n.profile_id)||"",patientName:`${null==n?void 0:n.first_name} ${null==n?void 0:n.last_name}`,preferredDate:new Date,urgency:"medium",symptoms:"",duration:30,type:"consultation"}})}),"analytics"===w&&s.jsxs(V.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsxs(u,{children:[s.jsx(j,{className:"pb-3",children:s.jsxs(g,{className:"text-lg flex items-center gap-2",children:[s.jsx(T,{className:"w-5 h-5 text-blue-600"}),"Total Appointments"]})}),s.jsx(f,{children:s.jsx("div",{className:"text-3xl font-bold text-blue-600",children:(null==q?void 0:q.appointments.length)||0})})]}),s.jsxs(u,{children:[s.jsx(j,{className:"pb-3",children:s.jsxs(g,{className:"text-lg flex items-center gap-2",children:[s.jsx(te,{className:"w-5 h-5 text-green-600"}),"Completed Today"]})}),s.jsx(f,{children:s.jsx("div",{className:"text-3xl font-bold text-green-600",children:(null==q?void 0:q.appointments.filter(e=>"completed"===e.status&&new Date(e.appointmentDate).toDateString()===(new Date).toDateString()).length)||0})})]}),s.jsxs(u,{children:[s.jsx(j,{className:"pb-3",children:s.jsxs(g,{className:"text-lg flex items-center gap-2",children:[s.jsx(G,{className:"w-5 h-5 text-purple-600"}),"AI Optimizations"]})}),s.jsx(f,{children:s.jsx("div",{className:"text-3xl font-bold text-purple-600",children:"18"})})]}),s.jsxs(u,{children:[s.jsx(j,{className:"pb-3",children:s.jsxs(g,{className:"text-lg flex items-center gap-2",children:[s.jsx(Z,{className:"w-5 h-5 text-orange-600"}),"Efficiency Rate"]})}),s.jsx(f,{children:s.jsx("div",{className:"text-3xl font-bold text-orange-600",children:"94%"})})]})]}),s.jsxs(u,{children:[s.jsx(j,{children:s.jsx(g,{children:"Appointment Analytics"})}),s.jsx(f,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-2",children:"Status Distribution"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Scheduled:"}),s.jsx("span",{className:"font-semibold",children:"45%"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Completed:"}),s.jsx("span",{className:"font-semibold",children:"35%"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Cancelled:"}),s.jsx("span",{className:"font-semibold",children:"20%"})]})]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600 mb-2",children:"Type Distribution"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Consultation:"}),s.jsx("span",{className:"font-semibold",children:"60%"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Follow-up:"}),s.jsx("span",{className:"font-semibold",children:"25%"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Emergency:"}),s.jsx("span",{className:"font-semibold",children:"15%"})]})]})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-2",children:"AI Insights"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Optimal Slots:"}),s.jsx("span",{className:"font-semibold",children:"78%"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Conflict Resolved:"}),s.jsx("span",{className:"font-semibold",children:"92%"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Waitlist Success:"}),s.jsx("span",{className:"font-semibold",children:"85%"})]})]})]})]})})]})]}),c&&s.jsx(be,{appointment:m,patients:(null==P?void 0:P.patients)||[],doctors:(null==L?void 0:L.doctors)||[],onClose:K,onSuccess:()=>{i.invalidateQueries({queryKey:["appointments"]}),K(),a({title:t("common.success"),description:m?"Appointment updated successfully":"Appointment created successfully"})}}),y&&(null==$?void 0:$.canReview)&&s.jsx(Ne,{appointmentId:y.id,doctorName:U(y),appointmentDate:new Date(y.appointmentDate),onClose:H,onSuccess:()=>{i.invalidateQueries({queryKey:["appointments"]}),i.invalidateQueries({queryKey:["reviews"]}),H()}})]})}je.displayName=ue;export{ke as AppointmentsPage};
